module.exports=[85961,a=>{"use strict";var b=a.i(68316),c=a.i(92132),d=a.i(10849);a.i(95507);var e=a.i(7536),f=(0,e.createServerReference)("0048dcfaa6b58a52a88fe46dca566ac0267b67cd50",e.callServer,void 0,e.findSourceMapURL,"listPages");function g(){let a=(0,c.useTenantId)(),[d,e]=(0,b.useState)([]),[g,h]=(0,b.useState)(!0);return(0,b.useEffect)(()=>{a?async function(){try{h(!0);let a=await f();if(a.error){e([]),h(!1);return}let b=(a.data||[]).map(a=>({id:a.id,title:a.title,slug:a.slug,status:a.status,updatedAt:a.updated_at,updated_at:a.updated_at,blocks:[]}));e(b),h(!1)}catch(a){e([]),h(!1)}}():h(!1)},[a]),{pages:d,setPages:e,addPage:a=>{e(b=>[a,...b])},updatePage:(a,b)=>{e(c=>c.map(c=>c.id===a?{...c,...b}:c))},deletePage:a=>{e(b=>b.filter(b=>b.id!==a))},isLoading:g}}function h(a){let e=(0,c.useTenantId)(),[f,g]=(0,b.useState)(void 0),[h,i]=(0,b.useState)(!0);return(0,b.useEffect)(()=>{e&&a&&"new"!==a?async function(){try{i(!0);let b=(0,d.supabaseBrowser)(),{data:c,error:f}=await b.from("tenants").select("id").eq("id",e).maybeSingle();if(f||!c)return void i(!1);let{data:h,error:j}=await b.from("pages").select("*").eq("id",a).eq("tenant_id",c.id).maybeSingle();if(j||!h)return void i(!1);let{data:k}=await b.from("page_versions").select("content").eq("page_id",a).order("version_number",{ascending:!1}).limit(1).maybeSingle(),l={id:h.id,title:h.title,slug:h.slug,status:h.status,updatedAt:h.updated_at,updated_at:h.updated_at,blocks:k?.content?.sections||[]};g(l),i(!1)}catch(a){i(!1)}}():i(!1)},[e,a]),{page:f,isLoading:h}}function i(a){let e=(0,c.useTenantId)(),[f,g]=(0,b.useState)([]),[h,i]=(0,b.useState)(!0);return(0,b.useEffect)(()=>{e&&a&&"new"!==a?async function(){try{i(!0);let b=(0,d.supabaseBrowser)(),{data:c}=await b.from("page_versions").select("content").eq("page_id",a).order("version_number",{ascending:!1}).limit(1).maybeSingle(),e=(c?.content?.sections||[]).map((a,b)=>({id:a.id||`block-${b}`,type:a.type,data:a.props||{},props:a.props||{}}));g(e),i(!1)}catch(a){g([]),i(!1)}}():i(!1)},[e,a]),{blocks:f,setBlocks:g,isLoading:h}}a.s(["usePage",()=>h,"usePageBlocks",()=>i,"usePages",()=>g],85961)},20714,a=>{"use strict";var b=a.i(68316);let c=0,d=new Map,e=a=>{if(d.has(a))return;let b=setTimeout(()=>{d.delete(a),h({type:"REMOVE_TOAST",toastId:a})},1e6);d.set(a,b)},f=[],g={toasts:[]};function h(a){g=((a,b)=>{switch(b.type){case"ADD_TOAST":return{...a,toasts:[b.toast,...a.toasts].slice(0,1)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(a=>a.id===b.toast.id?{...a,...b.toast}:a)};case"DISMISS_TOAST":{let{toastId:c}=b;return c?e(c):a.toasts.forEach(a=>{e(a.id)}),{...a,toasts:a.toasts.map(a=>a.id===c||void 0===c?{...a,open:!1}:a)}}case"REMOVE_TOAST":if(void 0===b.toastId)return{...a,toasts:[]};return{...a,toasts:a.toasts.filter(a=>a.id!==b.toastId)}}})(g,a),f.forEach(a=>{a(g)})}function i({...a}){let b=(c=(c+1)%Number.MAX_SAFE_INTEGER).toString(),d=()=>h({type:"DISMISS_TOAST",toastId:b});return h({type:"ADD_TOAST",toast:{...a,id:b,open:!0,onOpenChange:a=>{a||d()}}}),{id:b,dismiss:d,update:a=>h({type:"UPDATE_TOAST",toast:{...a,id:b}})}}function j(){let[a,c]=b.useState(g);return b.useEffect(()=>(f.push(c),()=>{let a=f.indexOf(c);a>-1&&f.splice(a,1)}),[a]),{...a,toast:i,dismiss:a=>h({type:"DISMISS_TOAST",toastId:a})}}a.s(["useToast",()=>j])},80020,a=>{"use strict";var b=a.i(44279),c=a.i(68316),d=a.i(64338),e=c.forwardRef((a,c)=>(0,b.jsx)(d.Primitive.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));e.displayName="Label";var f=a.i(94027);function g({className:a,...c}){return(0,b.jsx)(e,{"data-slot":"label",className:(0,f.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...c})}a.s(["Label",()=>g],80020)},16846,a=>{"use strict";var b=a.i(29382);a.s(["Check",()=>b.default])},31613,a=>{"use strict";let b=(0,a.i(5097).default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);a.s(["Copy",()=>b],31613)},92132,a=>{"use strict";var b=a.i(90785),c=a.i(27017);function d(){let{tenantId:a}=(0,c.useTenant)(),d=(0,b.useSearchParams)().get("tenant");return a||d||null}a.s(["useTenantId",()=>d])},95685,a=>{"use strict";let b=(0,a.i(5097).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);a.s(["Trash2",()=>b],95685)},95507,a=>{"use strict";a.s([])},7536,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(44473),g=a.r(53478),h=a.r(38261)},37383,a=>{"use strict";var b=a.i(44279),c=a.i(94027);function d({className:a,type:d,...e}){return(0,b.jsx)("input",{type:d,"data-slot":"input",className:(0,c.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...e})}a.s(["Input",()=>d])},70469,61116,a=>{"use strict";let b=(0,a.i(5097).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],70469);var c=a.i(44279),d=a.i(94027);function e({className:a,...b}){return(0,c.jsx)("textarea",{"data-slot":"textarea",className:(0,d.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...b})}a.s(["Textarea",()=>e],61116)},75993,6252,a=>{"use strict";let b=(0,a.i(5097).default)("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);a.s(["GripVertical",()=>b],75993);var c=a.i(68316);function d(a){let b=c.useRef({value:a,previous:a});return c.useMemo(()=>(b.current.value!==a&&(b.current.previous=b.current.value,b.current.value=a),b.current.previous),[a])}a.s(["usePrevious",()=>d],6252)},74380,a=>{"use strict";let b=(0,a.i(5097).default)("GlobeLock",[["path",{d:"M15.686 15A14.5 14.5 0 0 1 12 22a14.5 14.5 0 0 1 0-20 10 10 0 1 0 9.542 13",key:"qkt0x6"}],["path",{d:"M2 12h8.5",key:"ovaggd"}],["path",{d:"M20 6V4a2 2 0 1 0-4 0v2",key:"1of5e8"}],["rect",{width:"8",height:"5",x:"14",y:"6",rx:"1",key:"1fmf51"}]]);a.s(["GlobeLock",()=>b],74380)},37349,a=>{"use strict";let b=(0,a.i(5097).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],37349)},39639,(a,b,c)=>{var d=0/0,e=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,h=/^0o[0-7]+$/i,i=parseInt,j=a.g&&a.g.Object===Object&&a.g,k="object"==typeof self&&self&&self.Object===Object&&self,l=j||k||Function("return this")(),m=Object.prototype.toString,n=Math.max,o=Math.min,p=function(){return l.Date.now()};function q(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function r(a){if("number"==typeof a)return a;if("symbol"==typeof(b=a)||b&&"object"==typeof b&&"[object Symbol]"==m.call(b))return d;if(q(a)){var b,c="function"==typeof a.valueOf?a.valueOf():a;a=q(c)?c+"":c}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(e,"");var j=g.test(a);return j||h.test(a)?i(a.slice(2),j?2:8):f.test(a)?d:+a}b.exports=function(a,b,c){var d,e,f,g,h,i,j=0,k=!1,l=!1,m=!0;if("function"!=typeof a)throw TypeError("Expected a function");function s(b){var c=d,f=e;return d=e=void 0,j=b,g=a.apply(f,c)}function t(a){var c=a-i,d=a-j;return void 0===i||c>=b||c<0||l&&d>=f}function u(){var a,c,d,e=p();if(t(e))return v(e);h=setTimeout(u,(a=e-i,c=e-j,d=b-a,l?o(d,f-c):d))}function v(a){return(h=void 0,m&&d)?s(a):(d=e=void 0,g)}function w(){var a,c=p(),f=t(c);if(d=arguments,e=this,i=c,f){if(void 0===h)return j=a=i,h=setTimeout(u,b),k?s(a):g;if(l)return h=setTimeout(u,b),s(i)}return void 0===h&&(h=setTimeout(u,b)),g}return b=r(b)||0,q(c)&&(k=!!c.leading,f=(l="maxWait"in c)?n(r(c.maxWait)||0,b):f,m="trailing"in c?!!c.trailing:m),w.cancel=function(){void 0!==h&&clearTimeout(h),j=0,d=i=e=h=void 0},w.flush=function(){return void 0===h?g:v(p())},w}},50534,a=>{"use strict";var b=a.i(44279),c=a.i(68316),d=a.i(51496);let e=(0,a.i(5097).default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var f=a.i(70469),g=a.i(94027),h=a.i(7536),i=(0,h.createServerReference)("40295af451c37fe4e2d0e1c9350d8a63cf8237a8f3",h.callServer,void 0,h.findSourceMapURL,"uploadImageForTenant"),j=a.i(20714);function k({value:a,onChange:h,className:k,placeholder:l="Upload image"}){let m=(0,c.useRef)(null),[n,o]=(0,c.useState)(a||null),[p,q]=(0,c.useState)(!1),{toast:r}=(0,j.useToast)(),s=async a=>{let b=a.target.files?.[0];if(!b)return;let c=URL.createObjectURL(b);o(c),q(!0);try{let a=await i(b);if("error"in a&&a.error){r({title:"Upload failed",description:a.error,variant:"destructive"}),o(null),m.current&&(m.current.value="");return}"data"in a&&a.data&&(URL.revokeObjectURL(c),o(a.data.url),h(a.data.url),r({title:"Upload successful",description:"Image uploaded successfully"}))}catch(a){r({title:"Upload failed",description:a instanceof Error?a.message:"Unknown error",variant:"destructive"}),o(null),m.current&&(m.current.value="")}finally{q(!1)}};return(0,b.jsxs)("div",{onClick:()=>m.current?.click(),className:(0,g.cn)("group relative flex cursor-pointer items-center justify-center overflow-hidden border-2 border-dashed border-border bg-muted/30 transition-colors hover:border-primary/50",k),children:[(0,b.jsx)("input",{ref:m,type:"file",accept:"image/*",onChange:s,className:"hidden"}),n||a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("img",{src:n||a,alt:"",className:"h-full w-full object-cover"}),p&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:(0,b.jsx)(f.Loader2,{className:"h-6 w-6 animate-spin text-white"})}),(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),n&&n.startsWith("blob:")&&URL.revokeObjectURL(n),o(null),h(""),m.current&&(m.current.value="")},disabled:p,className:"absolute right-2 top-2 flex h-6 w-6 items-center justify-center rounded-full bg-destructive text-destructive-foreground opacity-0 transition-opacity group-hover:opacity-100 disabled:opacity-50",children:(0,b.jsx)(d.X,{className:"h-4 w-4"})})]}):(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[p?(0,b.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin"}):(0,b.jsx)(e,{className:"h-8 w-8"}),(0,b.jsx)("span",{className:"text-sm",children:p?"Uploading...":l})]})]})}a.s(["ImageUploader",()=>k],50534)}];

//# sourceMappingURL=_c39ada96._.js.map