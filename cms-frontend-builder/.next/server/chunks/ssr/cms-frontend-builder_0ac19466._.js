module.exports=[18265,a=>{"use strict";var b=a.i(68316),c=a.i(92132);a.i(95507);var d=a.i(7536),e=(0,d.createServerReference)("0009b2d854ecdafc67348394fb57003b51618a8d67",d.callServer,void 0,d.findSourceMapURL,"listPosts"),f=(0,d.createServerReference)("400156b8ce56fc4d15c8949f5298bb26e8bd76e735",d.callServer,void 0,d.findSourceMapURL,"getPostById");function g(){let a=(0,c.useTenantId)(),[d,f]=(0,b.useState)([]),[g,h]=(0,b.useState)(!0);return(0,b.useEffect)(()=>{a?async function(){try{h(!0);let a=await e();if(a.error){f([]),h(!1);return}let b=(a.data||[]).map(a=>({id:a.id,title:a.title,slug:a.slug,status:a.status,publishedAt:a.published_at,published_at:a.published_at,coverImage:null,excerpt:a.excerpt,content:a.content}));f(b),h(!1)}catch(a){f([]),h(!1)}}():h(!1)},[a]),{posts:d,setPosts:f,addPost:a=>{f(b=>[a,...b])},updatePost:(a,b)=>{f(c=>c.map(c=>c.id===a?{...c,...b}:c))},deletePost:a=>{f(b=>b.filter(b=>b.id!==a))},isLoading:g}}function h(a){let d=(0,c.useTenantId)(),[e,g]=(0,b.useState)(void 0),[h,i]=(0,b.useState)(!0);return(0,b.useEffect)(()=>{d&&a&&"new"!==a?async function(){try{i(!0);let b=await f(a);if(b.error||!b.data)return void i(!1);let c=b.data,d={id:c.id,title:c.title,slug:c.slug,status:c.status,publishedAt:c.published_at,published_at:c.published_at,coverImage:null,excerpt:c.excerpt,content:c.content};g(d),i(!1)}catch(a){i(!1)}}():i(!1)},[d,a]),{post:e,isLoading:h}}a.s(["usePost",()=>h,"usePosts",()=>g],18265)},73430,a=>{"use strict";let b=(0,a.i(5097).default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],73430)},63102,a=>{"use strict";var b=a.i(44279),c=a.i(68316),d=a.i(90785),e=a.i(86719),f=a.i(48325),g=a.i(37349),h=a.i(16846),i=a.i(70469),j=a.i(61291),k=a.i(74380),l=a.i(73430),m=a.i(95685),n=a.i(52604),o=a.i(78359),p=a.i(37383),q=a.i(61116),r=a.i(80020),s=a.i(18265);a.i(95507);var t=a.i(7536),u=(0,t.createServerReference)("60cfe21fb47c55e72566083d6e3bfae73f4e6a1b99",t.callServer,void 0,t.findSourceMapURL,"savePost"),v=(0,t.createServerReference)("40c80e633c8e2df83cc9a46c9ca2ff309b6b386966",t.callServer,void 0,t.findSourceMapURL,"publishPost"),w=(0,t.createServerReference)("404f5fc8f4e44d57403f3a9b4c7b058fdd80ad216c",t.callServer,void 0,t.findSourceMapURL,"deletePost"),x=a.i(39639),y=a.i(50534),z=a.i(20714);function A({params:a}){let{id:t}=(0,c.use)(a),A=(0,d.useRouter)(),B="new"===t,{post:C}=(0,s.usePost)(B?"1":t),{addPost:D,updatePost:E,deletePost:F}=(0,s.usePosts)(),[G,H]=(0,c.useState)({title:"",slug:"",content:"",coverImage:null,status:"draft"}),[I,J]=(0,c.useState)("idle"),[K,L]=(0,c.useState)(!0),{toast:M}=(0,z.useToast)(),[N,O]=(0,c.useTransition)();(0,c.useEffect)(()=>{C&&!B&&H(C)},[C,B]);let P=(0,c.useCallback)((0,x.default)(async(a,b)=>{(b.title||b.content)&&O(async()=>{J("saving");let c=await u("new"===a?null:a,{title:b.title||"",slug:b.slug||S(b.title||""),excerpt:b.excerpt||"",content:b.content||"",coverImage:b.coverImage||null,status:("archived"===b.status?"draft":b.status)||"draft"});c.error?(M({title:"Error",description:c.error,variant:"destructive"}),J("idle")):(J("saved"),setTimeout(()=>J("idle"),2e3),B&&c.data&&A.replace(`/posts/${c.data.id}`))})},1e3),[M,B,A]);(0,c.useEffect)(()=>((G.title||G.content)&&P(t,G),()=>{P.cancel()}),[G,P,t]);let Q=async()=>{if(B){let a=await u(null,{title:G.title||"",slug:G.slug||S(G.title||""),excerpt:G.excerpt||"",content:G.content||"",coverImage:G.coverImage||null,status:"published"});return a.error||!a.data?void M({title:"Error",description:a.error||"Failed to save post",variant:"destructive"}):(A.replace(`/posts/${a.data.id}`),H(b=>({...b,status:"published",id:a.data.id})),void M({title:"Published",description:"Post is now live"}))}O(async()=>{let a="published"===G.status?"draft":"published";if("published"===a){let a=await v(t);if(a.error)return void M({title:"Error",description:a.error,variant:"destructive"})}else{let a=await u(t,{title:G.title||"",slug:G.slug||"",excerpt:G.excerpt||"",content:G.content||"",coverImage:G.coverImage||null,status:"draft"});if(a.error)return void M({title:"Error",description:a.error,variant:"destructive"})}H(b=>({...b,status:a})),E(t,{status:a,publishedAt:"published"===a?new Date().toISOString():null}),M({title:"published"===a?"Published":"Unpublished",description:"published"===a?"Post is now live":"Post is now a draft"})})},R=async()=>{if(confirm("Are you sure you want to delete this post?")){if(B)return void A.push("/posts");O(async()=>{let a=await w(t);a.error?M({title:"Error",description:a.error,variant:"destructive"}):(F(t),A.push("/posts"),M({title:"Deleted",description:"Post deleted successfully"}))})}},S=a=>a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");return(0,b.jsxs)("div",{className:"flex h-[calc(100vh-4rem)] flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(o.Button,{variant:"ghost",size:"icon",asChild:!0,className:"rounded-xl",children:(0,b.jsx)(n.default,{href:"/posts",children:(0,b.jsx)(g.ArrowLeft,{className:"h-5 w-5"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"font-semibold",children:B?"Νέο Άρθρο":G.title||"Χωρίς τίτλο"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:G.slug?`/${G.slug}`:"/untitled"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.AnimatePresence,{mode:"wait",children:"idle"!==I&&(0,b.jsx)(e.motion.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},className:"flex items-center gap-2 text-sm text-muted-foreground",children:"saving"===I?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader2,{className:"h-4 w-4 animate-spin"}),"Αποθήκευση..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Check,{className:"h-4 w-4 text-primary"}),"Αποθηκεύτηκε"]})})}),(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>L(!K),className:"gap-2 rounded-xl",children:[(0,b.jsx)(l.Eye,{className:"h-4 w-4"}),K?"Απόκρυψη":"Προεπισκόπηση"]}),!B&&(0,b.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:R,className:"gap-2 rounded-xl text-destructive hover:bg-destructive/10 bg-transparent",children:[(0,b.jsx)(m.Trash2,{className:"h-4 w-4"}),"Διαγραφή"]}),(0,b.jsx)(o.Button,{onClick:Q,variant:"published"===G.status?"secondary":"default",size:"sm",className:"gap-2 rounded-xl",children:"published"===G.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.GlobeLock,{className:"h-4 w-4"}),"Αποδημοσίευση"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Globe,{className:"h-4 w-4"}),"Δημοσίευση"]})})]})]}),(0,b.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,b.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,b.jsxs)("div",{className:"mx-auto max-w-2xl space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Τίτλος"}),(0,b.jsx)(p.Input,{value:G.title||"",onChange:a=>{let b=a.target.value;H(a=>({...a,title:b,slug:a.slug||S(b)}))},placeholder:"Τίτλος άρθρου",className:"rounded-xl text-lg"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Slug"}),(0,b.jsx)(p.Input,{value:G.slug||"",onChange:a=>H(b=>({...b,slug:a.target.value})),placeholder:"post-slug",className:"rounded-xl font-mono text-sm"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Εικόνα Εξωφύλλου"}),(0,b.jsx)(y.ImageUploader,{value:G.coverImage||"",onChange:a=>H(b=>({...b,coverImage:a})),className:"aspect-video rounded-xl"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(r.Label,{children:"Περιεχόμενο (Markdown)"}),(0,b.jsx)(q.Textarea,{value:G.content||"",onChange:a=>H(b=>({...b,content:a.target.value})),placeholder:"Γράψτε το περιεχόμενο σε Markdown...",className:"min-h-[400px] rounded-xl font-mono text-sm"})]})]})}),(0,b.jsx)(f.AnimatePresence,{children:K&&(0,b.jsx)(e.motion.div,{initial:{width:0,opacity:0},animate:{width:400,opacity:1},exit:{width:0,opacity:0},className:"shrink-0 overflow-y-auto border-l border-border bg-muted/30",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("p",{className:"mb-4 text-sm font-medium text-muted-foreground",children:"Προεπισκόπηση"}),(0,b.jsxs)("article",{className:"prose prose-sm dark:prose-invert",children:[G.coverImage&&(0,b.jsx)("img",{src:G.coverImage||"/placeholder.svg",alt:"",className:"mb-6 aspect-video w-full rounded-xl object-cover"}),(0,b.jsx)("h1",{className:"text-2xl font-bold",children:G.title||"Χωρίς τίτλο"}),(0,b.jsx)("div",{className:"mt-4 whitespace-pre-wrap text-muted-foreground",children:G.content||"Ξεκινήστε να γράφετε για να δείτε την προεπισκόπηση..."})]})]})})})]})]})}a.s(["default",()=>A],63102)}];

//# sourceMappingURL=cms-frontend-builder_0ac19466._.js.map