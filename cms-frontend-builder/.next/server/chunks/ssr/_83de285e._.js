module.exports=[34699,a=>{"use strict";var b=a.i(34445);a.i(52434);var c=a.i(13422),d=a.i(80494);async function e(){try{let a=await (0,b.headers)(),e=a.get("host")||a.get("x-forwarded-host");if(e){let a=e.split(":")[0].split(".");if(a.length>2){let b=a[0],c=(0,d.supabaseServer)(),{data:e,error:f}=await c.from("tenants").select("id").eq("slug",b).maybeSingle();if(e&&!f)return e.id}}let f=await (0,b.cookies)(),g=(0,c.createServerClient)("https://qgisnksjztjczsrbjryr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFnaXNua3NqenRqY3pzcmJqcnlyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUwNTI0ODcsImV4cCI6MjA4MDYyODQ4N30.B9j69ZAWHxEKvgJC0B_4iVtj45h2USfbWWssIQCx_DA",{cookies:{get:a=>f.get(a)?.value}}),{data:{user:h}}=await g.auth.getUser();if(h){let{data:a,error:b}=await g.from("tenant_users").select("tenant_id").eq("user_id",h.id).limit(1).maybeSingle();if(a?.tenant_id&&!b)return a.tenant_id}let i=(0,d.supabaseServer)(),{data:j,error:k}=await i.from("tenants").select("id").eq("slug","kalitechnia").maybeSingle();if(j&&!k)return j.id;return null}catch(a){return console.error("Error getting tenant ID:",a),null}}a.s(["getTenantIdForServerAction",()=>e])},89290,a=>{"use strict";var b=a.i(34445);async function c(){let a=await (0,b.headers)(),c=a.get("host")||a.get("x-forwarded-host");if(!c)return null;let d=c.split(":")[0],e=d.split(".");return e.length>2?e[0]:null}a.s(["getTenantId",()=>c])},74137,a=>{"use strict";var b=a.i(64898),c=a.i(80494),d=a.i(34699),e=a.i(93879);async function f(){try{let a=await (0,d.getTenantIdForServerAction)();if(!a)return{error:"Tenant not found"};let b=(0,c.supabaseServer)(),{data:e,error:f}=await b.from("posts").select("*").eq("tenant_id",a).order("updated_at",{ascending:!1});if(f)return{error:f.message};return{data:e||[]}}catch(a){return{error:a instanceof Error?a.message:"Unknown error"}}}async function g(a){try{let b=await (0,d.getTenantIdForServerAction)();if(!b)return{error:"Tenant not found"};let e=(0,c.supabaseServer)(),{data:f,error:g}=await e.from("posts").select("*").eq("id",a).eq("tenant_id",b).single();if(g)return{error:g.message};return{data:f}}catch(a){return{error:a instanceof Error?a.message:"Unknown error"}}}async function h(a,b){try{let f=await (0,d.getTenantIdForServerAction)();if(!f)return{error:"Tenant not found"};let g=(0,c.supabaseServer)();if(a){let{data:c,error:d}=await g.from("posts").update({title:b.title,slug:b.slug,excerpt:b.excerpt||null,content:b.content,status:b.status||"draft",published_at:"published"===b.status?new Date().toISOString():null}).eq("id",a).eq("tenant_id",f).select().single();if(d)return{error:d.message};return(0,e.revalidatePath)("/"),{data:c}}{let{data:a,error:c}=await g.from("posts").insert({tenant_id:f,title:b.title,slug:b.slug,excerpt:b.excerpt||null,content:b.content,status:b.status||"draft",published_at:"published"===b.status?new Date().toISOString():null}).select().single();if(c)return{error:c.message};return(0,e.revalidatePath)("/"),{data:a}}}catch(a){return{error:a instanceof Error?a.message:"Unknown error"}}}async function i(a){try{let b=await (0,d.getTenantIdForServerAction)();if(!b)return{error:"Tenant not found"};let f=(0,c.supabaseServer)(),{data:g,error:h}=await f.from("posts").update({status:"published",published_at:new Date().toISOString()}).eq("id",a).eq("tenant_id",b).select().single();if(h)return{error:h.message};return(0,e.revalidatePath)("/"),{data:g}}catch(a){return{error:a instanceof Error?a.message:"Unknown error"}}}async function j(a){try{let b=await (0,d.getTenantIdForServerAction)();if(!b)return{error:"Tenant not found"};let f=(0,c.supabaseServer)(),{error:g}=await f.from("posts").delete().eq("id",a).eq("tenant_id",b);if(g)return{error:g.message};return(0,e.revalidatePath)("/"),{data:{success:!0}}}catch(a){return{error:a instanceof Error?a.message:"Unknown error"}}}(0,a.i(57097).ensureServerEntryExports)([f,g,h,i,j]),(0,b.registerServerReference)(f,"00f59a902a7360d1b224ddb69b8b5366be59364fe9",null),(0,b.registerServerReference)(g,"40a2c4fed05047b8ba44eda8fa8b4945b6704baaf3",null),(0,b.registerServerReference)(h,"6013eccb6d7c0b20d42c8bd7f31858eded51a2c756",null),(0,b.registerServerReference)(i,"40796b7744a6950fdb8826b62319a9ecc9e3809be4",null),(0,b.registerServerReference)(j,"402cce156c30788541ccb34576027a5f461364e20e",null),a.s(["deletePost",()=>j,"getPostById",()=>g,"listPosts",()=>f,"publishPost",()=>i,"savePost",()=>h])},30545,a=>{"use strict";var b=a.i(64898),c=a.i(80494),d=a.i(89290);async function e(a,b){try{let d=(0,c.supabaseServer)(),e=Date.now(),f=Math.random().toString(36).substring(2,15),g=a.name.split(".").pop(),h=`${e}-${f}.${g}`,i=`/${b}/uploads/${h}`,j=await a.arrayBuffer(),{data:k,error:l}=await d.storage.from("public").upload(i,j,{contentType:a.type,upsert:!0});if(l)return{error:l.message};let{data:{publicUrl:m}}=d.storage.from("public").getPublicUrl(i);return{data:{url:m,path:i}}}catch(a){return{error:a instanceof Error?a.message:"Unknown error"}}}async function f(a){try{let b=await (0,d.getTenantId)();if(!b)return{error:"Tenant not found"};let f=(0,c.supabaseServer)(),{data:g,error:h}=await f.from("tenants").select("id").eq("slug",b).single();if(h||!g)return{error:"Tenant not found"};return e(a,g.id)}catch(a){return{error:a instanceof Error?a.message:"Unknown error"}}}(0,a.i(57097).ensureServerEntryExports)([e,f]),(0,b.registerServerReference)(e,"6046574415eb8cd38fce46e1ee3145ea2f0d317fdb",null),(0,b.registerServerReference)(f,"40cb90cc8455bf9fab79982c9ca1cf8596507845fc",null),a.s(["uploadImageForTenant",()=>f])},84415,a=>{"use strict";var b=a.i(74137),c=a.i(30545);a.s([],68090),a.i(68090),a.s(["00f59a902a7360d1b224ddb69b8b5366be59364fe9",()=>b.listPosts,"402cce156c30788541ccb34576027a5f461364e20e",()=>b.deletePost,"40796b7744a6950fdb8826b62319a9ecc9e3809be4",()=>b.publishPost,"40a2c4fed05047b8ba44eda8fa8b4945b6704baaf3",()=>b.getPostById,"40cb90cc8455bf9fab79982c9ca1cf8596507845fc",()=>c.uploadImageForTenant,"6013eccb6d7c0b20d42c8bd7f31858eded51a2c756",()=>b.savePost],84415)}];

//# sourceMappingURL=_83de285e._.js.map